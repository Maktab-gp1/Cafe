{% extends 'dashboard/dashboard_base.html' %}
{% load static %}
{% block body %}
{% load filters %}
<!--  BEGIN MAIN CONTAINER  -->
    <div class="main-container sidebar-closed sbar-open" id="container">
     <div class="overlay"></div>
        <div class="search-overlay"></div>        
        {% include 'dashboard/sidebar.html' %}

        <!--  BEGIN CONTENT AREA  -->
        <div id="content" class="main-content">
            <div class="layout-px-spacing">
         
            <div class="container my-3 py-5">
                     <form method="get" action="">
                    <input type="hidden" name="export_csv" value="1">
                    <button type="submit" class="btn btn-primary py-sm-1 px-sm-3 me-4 m-2">Export</button>
                    </form>
            </div>
            
        
          <div class="container my-2 py-2">
            <table class="table table-dark table-striped" id="example">
                <thead>
                  <tr>
                    <th scope="col">ID</th>
                    <th scope="col">Phone</th>
                    <th scope="col">Table</th>
                    <th scope="col">created</th>
                    <th scope="col">Orders</th>
                    <th scope="col">Updated</th>
                    <th scope="col">Status</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody>
                    {% for order in object_list %}
                    <tr>
                        <th scope="row">{{order.id}}</th>
                        <td>{{order.phone}}</td>
                        <td>{{order.table}}</td>
                        <td>{{order.created}}</td>
                        <td>
                            <ul>
                                {% for item in order.items.all %}
                                    <li>{{item.product}} x{{item.quantity}}</li>
                                {% endfor %} 
                            </ul> 
                        </td>
                        <td>{{order.updated}}</td>
                        <td>
                        {{order.status}}
                        {% show_order order %} 
                        </td>
                    </tr>    
                    {% endfor %} 
                </tbody>
                
              </table>
          </div>
      </div>
  </div>

<script>
let dataTable;
let dataTableIsInitialized = false;



const initDataTable = async () => {
    if (dataTableIsInitialized) {
        dataTable.destroy();
    }
    
    dataTable = $("#example").DataTable( {
        columnDefs: [
            { className: "centered", targets: [0, 1, 2, 3, 4, 5, 6 ,7 ] },
          
        ],
        responsive: true,
        
        
    }); 
    dataTableIsInitialized = true;
};

window.addEventListener("load", async () => {
    await initDataTable();
});


</script>
 
    


{% endblock body %}       